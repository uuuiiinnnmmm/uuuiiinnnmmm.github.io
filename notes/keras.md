---
layout: page
title: 深度学习笔记：尝试keras构建模型
permalink: /notes/keras/
---

本文是我尝试用Keras搭建一个基础深度学习模型

*   **目录**
{:toc}

---

### 项目日志总结

以下是我本次从环境搭建到模型构建的全过程。

# **项目日志：本地 Keras 深度学习环境部署与模型构建**

*   **项目目标**: 建立一个完整、独立的本地开发环境，用于 TensorFlow/Keras 深度学习模型的开发、训练与评估，并成功部署 GPU 加速。
*   **执行日期**: 2025年9月18日
*   **技术栈**: `Anaconda`, `Python 3.9`, `TensorFlow`, `Keras`, `Jupyter Notebook`, `CUDA`

---

### **Phase 1: 环境搭建与配置**

*   **`1.1` 决策**: 确定使用 `Anaconda` 创建虚拟环境，以实现与系统主 Python 环境的隔离，确保依赖的纯净性。
*   **`1.2` 操作**:
    *   执行 `conda create --name tf_keras_env python=3.9` 创建虚拟环境。
    *   执行 `conda activate tf_keras_env` 激活环境。
*   **`1.3` 安装核心依赖**:
    *   执行 `pip install tensorflow` 安装 TensorFlow 及其集成的 Keras。
    *   执行 `pip install notebook matplotlib scikit-learn` 安装常用的数据科学辅助工具。
*   **`1.4` 状态**: 环境基础部分部署成功。一个名为 `tf_keras_env` 的独立环境已准备就绪。

### **Phase 2: 第一个模型的构建与训练**

*   **`2.1` 任务定义**: 构建一个神经网络，对 `Fashion-MNIST` 数据集进行图像分类。
*   **`2.2` 数据处理**:
    *   使用 `keras.datasets.fashion_mnist.load_data()` 加载数据。
    *   对图像像素值进行 ` / 255.0` 归一化处理。
*   **`2.3` 模型架构**:
    *   使用 `keras.Sequential` API 搭建了一个线性堆叠模型。
    *   **结构**: `Flatten(input)` -> `Dense(128, relu)` -> `Dropout(0.2)` -> `Dense(10, softmax)`.
*   **`2.4` 编译与训练**:
    *   **编译配置**: 优化器 `adam`，损失函数 `sparse_categorical_crossentropy`，评估指标 `accuracy`。
    *   **训练执行**: 使用 `.fit()` 方法对模型进行了 10 个 `epochs` 的训练。
*   **`2.5` 结果**: 模型在测试集上达到了预期的准确率。通过 `matplotlib` 成功可视化了训练过程中的准确率和损失曲线，并对预测结果进行了可视化展示。

### **Phase 3: GPU 环境验证与问题诊断**

*   **`3.1` 验证脚本**: 执行了关键的 GPU 验证脚本，核心代码为 `tf.config.list_physical_devices('GPU')`。
*   **`3.2` 问题定位**: 该脚本的结果直接导向两个分支：
    *   **成功**: 输出 "发现 N 个 GPU 设备"，表示环境完美。
    *   **失败**: 输出 "未发现 GPU 设备"，表示 **CUDA 环境配置存在问题**。
*   **`3.3` 诊断分析**: 针对“失败”情况，分析出问题的根源主要在于 **NVIDIA 驱动、CUDA Toolkit、cuDNN** 三者之间以及它们与 TensorFlow 版本的**不匹配**。
*   **`3.4` **当前待解决问题**: 在安装 CUDA 的具体过程中，对于是否需要安装其捆绑的 `Driver` 产生疑问。

### **Phase 4: 关键技术决策 - CUDA 安装策略**

*   **`4.1` 问题**: 在安装 CUDA Toolkit 时，应如何处理 NVIDIA 驱动程序？
*   **`4.2` 决策分析**:
    *   **选项A (精简安装)**: 同时安装 CUDA Toolkit 和其绑定的、经过验证的驱动。优点是稳定、可靠。
    *   **选项B (自定义安装)**: 只安装 CUDA Toolkit，保留系统中已有的驱动。优点是灵活，但前提是现有驱动版本必须满足 CUDA 的最低要求。
*   **`4.3` **最终决策**: 对于初次配置或追求稳定性的场景，强烈推荐**采用“精简 (Express)”安装方式**，以避免潜在的版本冲突。

---

### **项目总结**

本项目成功地完成了从零开始的本地 Keras 深度学习环境搭建，并构建、训练、评估了一个完整的图像分类模型。项目流程清晰，从环境隔离、代码实现到最终的硬件加速配置，覆盖了深度学习入门的全部关键环节。目前，项目已进入最后的 GPU 配置阶段，并已针对关键技术点（CUDA 安装策略）形成了明确的行动方案。

### **后续步骤**

1.  **执行**: 按照**策略一（精简安装）**完成 CUDA 和 cuDNN 的安装。
2.  **验证**: 重新激活 `tf_keras_env` 环境，并再次运行 GPU 验证脚本，确保 TensorFlow 能够成功识别 GPU。
3.  **性能对比**: 重新运行 Phase 2 中的模型训练代码，直观感受 GPU 加速带来的巨大性能提升。
4.  **探索**: 在此稳定环境的基础上，开始探索更复杂的模型和项目。
