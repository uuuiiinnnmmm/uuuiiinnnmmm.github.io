---
layout: page
title: 深度学习笔记：从 CNN、RNN 到 LSTM — 以步态识别为例
permalink: /notes/gait-recognition-lstm/
---

本文是我的“下肢步态识别”研究项目中所涉及核心算法的详细梳理与学习笔记。项目中，我们旨在解决一个典型的时间序列分类问题，这个过程促使我对几种主流的深度学习模型进行了深入的对比分析。

*   **目录**
{:toc}

---

## 问题背景：为何步态识别需要序列模型？

步态数据，无论来自加速度计还是陀螺仪，其核心特征在于**时间上的连续性**。当前时刻的姿态与前一时刻紧密相连。因此，一个有效的识别模型必须具备“记忆”能力，能够理解数据点之间的时间依赖关系。

## 方案探索：三种模型的对比与思考

### 1. 卷积神经网络 (CNN) - 空间特征的王者

CNN 通过卷积核自动提取局部特征，在图像识别等领域取得了SOTA成果。其核心结构包括：

*   **卷积层 (Convolutional Layer):** 负责特征提取。其本质是一个可学习的权重矩阵（卷积核）在输入数据上进行滑动窗口式的加权求和。对于二维图像，它能有效提取边缘、角点等空间特征。
    > **数学原理:** 离散卷积操作可以看作是 `(I * K)[i, j] = Σ_m Σ_n I[i-m, j-n] K[m, n]`，其中 I 是输入，K 是卷积核。在神经网络中，通常使用相关性运算（无翻转）代替严格的卷积。

*   **池化层 (Pooling Layer):** 负责信息压缩。通过在特征图上进行下采样（如最大池化或平均池化），在保留最显著特征的同时减少计算量，并提供一定程度的平移不变性。

*   **全连接层 (Fully Connected Layer):** 负责整合全局特征并分类。将所有提取到的高级特征“压平”成一维向量，然后通过标准的神经网络层进行加权求和与非线性激活，最终输出分类结果。

**【结论】** 虽然可以将一维时间序列数据视作“一维图像”并应用1D-CNN，但CNN本身缺乏显式的记忆机制，难以捕捉跨度较长的时间依赖性，因此不作为我们的首选。

### 2. 循环神经网络 (RNN) - 序列模型的开端

RNN 通过在模型中引入循环结构，将上一时间步的输出作为当前时间步的输入之一，从而实现了“记忆”功能。

*   **核心公式:** `hₜ = f(W_hh * hₜ₋₁ + W_xh * xₜ + b_h)`
    *   `hₜ` 是当前时刻的隐藏状态（记忆）。
    *   `hₜ₋₁` 是上一时刻的记忆。
    *   `xₜ` 是当前时刻的输入。
    *   `f` 通常是 `tanh` 等非线性激活函数。

*   **长期依赖问题 (Long-Term Dependency Problem):**
    在模型通过时间反向传播（BPTT）进行训练时，梯度会随着时间步的增加而连乘。这很容易导致**梯度消失**（梯度趋近于0，模型无法学习长期依赖）或**梯度爆炸**（梯度极大，训练不稳定）。因此，标准的 RNN 只能维持“短期记忆”。

**【结论】** RNN 的设计思想与我们的问题完美契合，但其“长期依赖”的固有缺陷使其难以在复杂的步态识别任务中取得理想效果。

### 3. 长短期记忆网络 (LSTM) - 解决长期依赖的利器

LSTM 是 RNN 的一种精心设计的变体，它通过引入**单元状态 (Cell State)** 和三个**门控机制 (Gates)**，成功解决了长期依赖问题。

*   **核心结构:**
    *   **单元状态 (Cₜ):** 像一条传送带，贯穿整个时间序列。信息可以在上面流动而基本保持不变，很容易实现长期记忆。
    *   **门控机制:** 由 Sigmoid 神经网络层和逐点相乘操作构成。Sigmoid 层的输出介于0和1之间，表示允许多少信息通过（0代表完全不允许，1代表完全允许）。

*   **三大门详解:**
    1.  **遗忘门 (Forget Gate):** 决定从单元状态中丢弃哪些信息。它查看 `hₜ₋₁` 和 `xₜ`，为上一时刻的单元状态 `Cₜ₋₁` 中的每个数字输出一个0到1之间的值。
    2.  **输入门 (Input Gate):** 决定让哪些新信息存储到单元状态中。它包括两部分：一个 Sigmoid 层决定要更新哪些值，一个 `tanh` 层创建一个新的候选值向量。
    3.  **输出门 (Output Gate):** 决定要从单元状态中输出什么。输出值将基于单元状态，但会经过一个过滤处理，并最终作为隐藏状态 `hₜ` 传递给下一时刻和输出层。

**【结论】** LSTM 通过其精巧的门控设计，能够有选择地让信息通过、更新和遗忘，是处理步态识别这类需要捕捉长期依赖关系的时间序列任务的理想选择。我们的项目最终也基于此模型展开。

---
